function stripeResponseHandler(status,response){var $form=$("#payment-form");if(response.error){var cardType=$.payment.cardType($(".cc-number").val());$(".cc-number").toggleInputError(!$.payment.validateCardNumber($(".cc-number").val()));$(".cc-cvc").toggleInputError(!$.payment.validateCardCVC($(".cc-cvc").val(),cardType));$(".cc-brand").text(cardType);$(".validation").removeClass("text-danger text-success");$(".validation").addClass($(".has-error").length?"text-danger":"text-success");$form.find(".payment-errors").text(response.error.message);$form.find(".submit").prop("disabled",false)}else{var token=response.id;$form.append($('<input type="hidden" name="stripeToken">').val(token));$.post($form.prop("action"),$form.serialize()).success(function(resp){$form.hide();var $successMessage=$("<div>");$successMessage.html("Thank you, payment was successfull.");$successMessage.addClass("success");$successMessage.insertAfter($form);$form.remove()}).fail(function(error){console.log(error);$form.find(".submit").prop("disabled",false)})}}$(function(){var $form=$("#payment-form"),$detailsForm=$("#details");$detailsForm.off("submit");$form.off("submit");$form.hide();$("[data-numeric]").payment("restrictNumeric");$(".cc-number").payment("formatCardNumber");$(".cc-exp").payment("formatCardExpiry");$(".cc-cvc").payment("formatCardCVC");$.fn.toggleInputError=function(erred){this.parent(".form-group").toggleClass("has-error",erred);return this};$detailsForm.on("submit",function(e){e.preventDefault();var $oThis=$(this);SuccessPage.sendDetails($oThis,function(){$oThis.fadeOut(200,function(){var cardPaymentTypeSelected=$('input[name="payment_type"][value=p_on_account]').is(":checked");if(cardPaymentTypeSelected){$form.fadeIn(200)}else{$form.off("submit");$form.remove();var $successMessage=$("<div>");$successMessage.html("Thank you, your information was updated.");$successMessage.insertAfter($detailsForm);$successMessage.addClass("success");$detailsForm.remove()}})});return false});$form.on("submit",function(event){event.preventDefault();$form.find(".submit").prop("disabled",true);Stripe.card.createToken($form,stripeResponseHandler);return false})});
